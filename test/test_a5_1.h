#include <gtest/gtest.h>

#include "a5_1/a5_1.h"

#include "test_util.h"

TEST(test_a5_1, keystream)
{
    uint8_t  key[8]       = {0x12, 0x23, 0x45, 0x67, 0x89, 0xAB, 0xCD, 0xEF};
    uint32_t frame        = 0x134;
    uint8_t  goodAtoB[15] = {0x53, 0x4E, 0xAA, 0x58, 0x2F, 0xE8, 0x15, 0x1A, 0xB6, 0xE1, 0x85, 0x5A, 0x72, 0x8C, 0x00};
    uint8_t  goodBtoA[15] = {0x24, 0xFD, 0x35, 0xA3, 0x5D, 0x5F, 0xB6, 0x52, 0x6D, 0x32, 0xF9, 0x06, 0xDF, 0x1A, 0xC0};
    uint8_t  AtoB[15]     = {0};
    uint8_t  BtoA[15]     = {0};

    a5_1_generate_keystream(key, frame, AtoB, BtoA);

    EXPECT_TRUE(my_equal_array_8bit(goodAtoB, AtoB, 15));
    EXPECT_TRUE(my_equal_array_8bit(goodBtoA, BtoA, 15));
}
